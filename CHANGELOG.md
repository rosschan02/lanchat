# Changelog

本文件记录 LanChat 项目的所有重大变更。

## [1.3.0] - 2026-02-26

### ✨ 新增功能

- 新增频道能力：支持管理员创建频道并分配频道成员。
- 新增频道会话：客户端侧边栏展示频道列表，支持频道消息收发、未读与 @ 提醒。
- 新增频道管理后台：管理员可在后台创建频道、编辑频道名称和成员。

### 🛠 优化与修复

- Electron 截图流程重构：支持工具栏按钮直接触发截图，保留快捷键；截图响应速度显著提升。
- Electron 截图清晰度优化：改为显示流抓帧并按高分屏比例裁剪，避免画面发糊。
- 修复文件消息入库失败：兼容旧版 `messages.type` 约束，自动迁移数据库以支持 `file` 类型。
- Socket 消息入口增强校验：补充文件消息格式校验与异常兜底，避免异常数据导致服务崩溃。
- 消息历史接口扩展：新增频道历史消息查询，并在搜索接口中支持频道范围检索。

## [1.2.0] - 2026-02-26

### ✨ 新增功能

- 新增消息撤回能力：支持发送者 2 分钟内撤回，管理员可跨时限撤回。
- 新增 @ 提及提醒：被提及用户收到实时提醒与未读标记。
- 新增消息搜索：支持在当前聊天或全部聊天中按关键词检索文本消息。
- 新增文件消息：支持普通文件上传、发送与下载。
- 新增表情面板：支持分类选择与最近使用记录。
- 新增消息右键菜单：可直接在消息上执行撤回操作。

### 🛠 优化与修复

- 聊天消息与搜索结果高亮改为“先转义再渲染”，修复 `v-html` 注入风险。
- Electron 文件下载流程补齐网络异常与 HTTP 状态码校验，失败反馈更明确。
- 会话未读逻辑增强：区分普通未读与 @ 提及未读。

## [1.1.0] - 2026-02-26

### 🔄 框架升级

将所有主要依赖升级到最新稳定版本，提升性能与安全性。

#### 客户端 (Client)

| 依赖 | 旧版本 | 新版本 |
|------|--------|--------|
| Vue | ^3.4.0 | ^3.5.29 |
| Vue Router | ^4.2.5 | ^4.5.0 |
| Pinia | ^2.1.7 | ^2.3.0 |
| Element Plus | ^2.5.0 | ^2.13.2 |
| Axios | ^1.6.5 | ^1.8.0 |
| Socket.IO Client | ^4.7.4 | ^4.8.0 |
| Day.js | ^1.11.10 | ^1.11.13 |
| Vite | ^5.0.0 | ^6.2.0 |
| @vitejs/plugin-vue | ^5.0.0 | ^5.2.0 |
| Electron | ^28.0.0 | ^35.0.0 |
| Electron Builder | ^24.9.1 | ^25.1.0 |
| Concurrently | ^8.2.2 | ^9.1.0 |
| Wait-on | ^7.2.0 | ^8.0.0 |

#### 服务端 (Server)

| 依赖 | 旧版本 | 新版本 |
|------|--------|--------|
| Express | ^4.18.2 | ^4.21.2 |
| Socket.IO | ^4.7.4 | ^4.8.0 |
| better-sqlite3 | ^11.0.0 | ^12.6.2 |
| dotenv | ^16.4.1 | ^16.4.7 |

### 📝 文档

- 更新 README.md，添加技术栈版本信息表
- 新增 CHANGELOG.md

## [1.0.0] - 初始版本

### 功能

- 账号密码登录认证
- 实时在线用户列表
- 群聊和私聊
- 图片发送
- 系统级截图（Ctrl+Shift+A 框选截屏）
- 系统托盘和消息通知
- 聊天记录持久化（SQLite）
- 后台用户管理（管理员）
